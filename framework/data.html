<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Model" href="model.html" /><link rel="prev" title="Overall" href="overall.html" />

    <link rel="shortcut icon" href="../_static/pointrix.ico"/><!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>Datapipeline - Pointrix</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Pointrix</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/pointrix_landscape_b.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Pointrix</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Get started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/run_first_model.html">Run your first model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/render_novel_view_gui.html">Using GUI and render novel view</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/define_your_model.html">Define your own model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/define_your_own_dataset.html">Define your own dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/define_your_trainer.html">Define your own trainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/learning_configuration.html">Learning the configuration in Pointrix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Framework</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overall.html">Overall</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Datapipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="trainer.html">Trainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="hook.html">Hook</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../API.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../code/cameras.html">camera</a></li>
<li class="toctree-l2"><a class="reference internal" href="../code/dataset.html">dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../code/point_cloud.html">point_cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="../code/exporter.html">exporter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../code/hook.html">hook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../code/logger.html">logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../code/model.html">model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../code/optimizer.html">optimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../code/render.html">renderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../code/trainer.html">trainer</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="datapipeline">
<h1>Datapipeline<a class="headerlink" href="#datapipeline" title="Link to this heading">#</a></h1>
<p>As shown in the diagram below, the data pipeline consists of three parts: <strong>ReformatData</strong>, <strong>Dataset</strong>, and <strong>DataPipeline</strong></p>
<ul class="simple">
<li><p><strong>ReformatData</strong>: Responsible for standardizing user datasets, i.e., converting them to the Pointrix format. Notice that the “Pointrix format” is different from the Dataset introduced below. If users employ their own datasets, they typically need to inherit this portion of the function. For instance, you have a dataset in Colmap format, then you need to inherit a class from ReformatData class, and accomplish your own way to read this kind of format and convert it to a standard DataFormat class such as BaseDataFormat. The detail of the example supporting Colmap format dataset can be accessed in the <code class="docutils literal notranslate"><span class="pre">dataset/colmap_data.py</span></code>.</p></li>
<li><p><strong>Dataset</strong>: Processes data in the standard format and supports batch size indexing in conjunction with DataLoader. Users usually do not need to overide this part. This “Dataset” will be used during the process of trainning and validation, while DataFormat (the class inherited from BaseDataFormat) class is only used during the process of reading data.</p></li>
<li><p><strong>DataPipeline</strong>: The standard data flow in Pointrix provides a stable data stream for the trainer. The key function of this class is <code class="docutils literal notranslate"><span class="pre">next_train()</span></code> and <code class="docutils literal notranslate"><span class="pre">next_val()</span></code>, this two function can return a batch (a Python list of Python’s Dictionary consisted by the Dataset’s content). And this batch will be used in rendering and loss computation.</p></li>
</ul>
<p><img alt="" src="../_images/data.svg" /></p>
<p><img alt="" src="../_images/framework-data-class-diagram.png" /></p>
<section id="the-procedure-of-the-data-read">
<h2>The Procedure of the Data Read<a class="headerlink" href="#the-procedure-of-the-data-read" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>The trainer’s init function call the construction function of the DataPipleline, and build the association to this DataPipeline object.</p></li>
<li><p>To construct DataPipleline object, the DataPipeline call the specific ReFormatData class as a tool to get the standard DataFormat object for trainning and validation, respectively. And these two standard DataFormat objects will be converted to two Dataset class objects, immediately. And the latter will be associated to the datapipeline for the whole life cycle.</p></li>
<li><p>Datapipeline will also save the SimplePointCloud object associated with BaseDataFormat. And this SimplePointCloud will be used to initialize the model’s pointcloud if it wasn’t set as random in configuration.</p></li>
<li><p>The train class call the “next_train” function one times per trainning iteration to get a batch used for rendering and loss computation. The same in the validation loop.</p></li>
</ol>
</section>
<section id="the-detail-of-each-part">
<h2>The Detail of Each Part<a class="headerlink" href="#the-detail-of-each-part" title="Link to this heading">#</a></h2>
<section id="reformatdata">
<h3>ReformatData<a class="headerlink" href="#reformatdata" title="Link to this heading">#</a></h3>
<p>You have to implement <code class="docutils literal notranslate"><span class="pre">load_camera()</span></code> and <code class="docutils literal notranslate"><span class="pre">load_image_filenames()</span></code> if you want to create a support to a new kind of dataset format.</p>
<p>Whenever the BaseReFormatData was created, the “load_data_list” will be called, and the overrode function of detail loading will be called. After the instance is created, you can get BaseFormat object by call its variable <code class="docutils literal notranslate"><span class="pre">data_list</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BaseReFormatData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The foundational classes for formating the data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_root: Path</span>
<span class="sd">        The root of the data.</span>
<span class="sd">    split: str</span>
<span class="sd">        The split of the data.</span>
<span class="sd">    cached_image: bool</span>
<span class="sd">        Whether to cache the image in memory.</span>
<span class="sd">    scale: float</span>
<span class="sd">        The scene scale of data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_root</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="o">...</span>

    <span class="k">def</span> <span class="nf">load_data_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">split</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseDataFormat</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The foundational function for formating the data</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        split: The split of the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">camera</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_camera</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="n">split</span><span class="p">)</span>
        <span class="n">image_filenames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_image_filenames</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="n">split</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_metadata</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="n">split</span><span class="p">)</span>
        <span class="n">pointcloud</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_pointcloud</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">BaseDataFormat</span><span class="p">(</span><span class="n">image_filenames</span><span class="p">,</span> <span class="n">camera</span><span class="p">,</span>
                              <span class="n">PointCloud</span><span class="o">=</span><span class="n">pointcloud</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">load_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">split</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Camera</span><span class="p">]:</span> <span class="o">...</span>

    <span class="k">def</span> <span class="nf">load_pointcloud</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimplePointCloud</span><span class="p">:</span> <span class="o">...</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The function for loading the Pointcloud for initialization of gaussian model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">load_image_filenames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">split</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span> <span class="o">...</span>

    <span class="k">def</span> <span class="nf">load_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">split</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span> <span class="o">...</span>

    <span class="k">def</span> <span class="nf">load_all_images</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">]:</span> <span class="o">...</span>

</pre></div>
</div>
</section>
<section id="dataformat">
<h3>DataFormat<a class="headerlink" href="#dataformat" title="Link to this heading">#</a></h3>
<p>The code below shows a typical DataFormat class. You don’t need to write a new one usually.</p>
<p>As the example shows, you need to give it a image filename list, a camera list and an optional metadata information to generate a BaseDataFormat object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">BaseDataFormat</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pointrix standard data format in Datapipeline.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    image_filenames: List[Path]</span>
<span class="sd">        The filenames of the images in data.</span>
<span class="sd">    Cameras: List[Camera]</span>
<span class="sd">        The camera parameters of the images in data.</span>
<span class="sd">    images: Optional[List[Image.Image]] = None</span>
<span class="sd">        The images in data, which are only needed when cached image is enabled in dataset.</span>
<span class="sd">    PointCloud: Union[SimplePointCloud, None] = None</span>
<span class="sd">        The pointclouds of the scene, which are used to initialize the gaussian model, enabling better results.</span>
<span class="sd">    metadata: Dict[str, Any] = field(default_factory=lambda: dict({}))</span>
<span class="sd">        Other information that is required for the dataset.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    1. The order of all data needs to be consistent.</span>
<span class="sd">    2. The length of all data needs to be consistent.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; data = BaseDataFormat(image_filenames, camera, metadata=metadata)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">image_filenames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;camera image filenames&quot;&quot;&quot;</span>
    <span class="n">Camera_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Camera</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;camera image list&quot;&quot;&quot;</span>
    <span class="n">images</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;camera parameters&quot;&quot;&quot;</span>
    <span class="n">PointCloud</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SimplePointCloud</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;precompute pointcloud&quot;&quot;&quot;</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">({}))</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;other information that is required for the dataset&quot;&quot;&quot;</span>

    <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="dataset">
<h3>Dataset<a class="headerlink" href="#dataset" title="Link to this heading">#</a></h3>
<p>You can override the Python’s Dataset class to create your own Dataset. But typically you have to support using BaseDataFormat to create Dataset,
and also support to use <code class="docutils literal notranslate"><span class="pre">[]</span></code> to get the image-related information, which will be used in rendering and loss computation. The example BaseImageDataset is shown below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">format_data</span><span class="p">:</span> <span class="n">BaseDataFormat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera_list</span> <span class="o">=</span> <span class="n">format_data</span><span class="o">.</span><span class="n">Camera_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="n">format_data</span><span class="o">.</span><span class="n">images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_file_names</span> <span class="o">=</span> <span class="n">format_data</span><span class="o">.</span><span class="n">image_filenames</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cameras</span> <span class="o">=</span> <span class="n">Cameras</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cameras</span><span class="o">.</span><span class="n">radius</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Transform cached images.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_transform_image</span><span class="p">(</span>
                <span class="n">image</span><span class="p">)</span> <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>	<span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="n">image_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_file_names</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">camera</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_transform_image</span><span class="p">(</span>
            <span class="n">image_file_name</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">camera</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">camera</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="n">image</span><span class="p">,</span>
            <span class="s2">&quot;camera&quot;</span><span class="p">:</span> <span class="n">camera</span><span class="p">,</span>
            <span class="s2">&quot;FovX&quot;</span><span class="p">:</span> <span class="n">camera</span><span class="o">.</span><span class="n">fovX</span><span class="p">,</span>
            <span class="s2">&quot;FovY&quot;</span><span class="p">:</span> <span class="n">camera</span><span class="o">.</span><span class="n">fovY</span><span class="p">,</span>
            <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">camera</span><span class="o">.</span><span class="n">image_height</span><span class="p">,</span>
            <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">camera</span><span class="o">.</span><span class="n">image_width</span><span class="p">,</span>
            <span class="s2">&quot;world_view_transform&quot;</span><span class="p">:</span> <span class="n">camera</span><span class="o">.</span><span class="n">world_view_transform</span><span class="p">,</span>
            <span class="s2">&quot;full_proj_transform&quot;</span><span class="p">:</span> <span class="n">camera</span><span class="o">.</span><span class="n">full_proj_transform</span><span class="p">,</span>
            <span class="s2">&quot;camera_center&quot;</span><span class="p">:</span> <span class="n">camera</span><span class="o">.</span><span class="n">camera_center</span><span class="p">,</span>
        <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id1">
<h3>DataPipeline<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>The DataPipeline is the interface that can be used for trainer and other part of the framework.</p>
<p>The creation of a Datapipeline means that the dataset is loaded. And trainer can use <code class="docutils literal notranslate"><span class="pre">next_train()</span></code> and <code class="docutils literal notranslate"><span class="pre">next_val()</span></code> to get a new batch of data. Whether using Python’s DataLoader can be chosen by yourself.</p>
<p>The SimplePointCloud can be found if you have a datapipeline. It can be used to initialize the Gaussian model’s point cloud. At the same time, the cameras’ parameters are associated to DataPipeline too.</p>
</section>
<section id="camera">
<h3>Camera<a class="headerlink" href="#camera" title="Link to this heading">#</a></h3>
<p><img alt="" src="../_images/framework-camera.png" /></p>
<section id="id2">
<h4>Camera<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Contains the initialization of the camera, ranging from store some basic parameters and pre-compute some information such as view transformation matrix.</p></li>
<li><p>Contains the function loading all the parameters of the camera to the device.</p></li>
<li><p>The specific parameters and implementation can be access in the code.</p></li>
</ul>
</section>
<section id="trainablecamera">
<h4>TrainableCamera<a class="headerlink" href="#trainablecamera" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Contains converting a batch of logarithmic representations of SE(3) matrices <code class="docutils literal notranslate"><span class="pre">log_transform</span></code>  to a batch of 4x4 SE(3) matrices using the exponential map, which can help us use 6D vectors to represent rigid transformation.</p></li>
<li><p>The 6D vectors representing transformation to the origin camera will also be load to device (GPU).</p></li>
</ul>
</section>
<section id="cameras">
<h4>Cameras<a class="headerlink" href="#cameras" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Contains a list of cameras.</p></li>
</ul>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="model.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Model</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="overall.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Overall</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Pointrix-Group
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Datapipeline</a><ul>
<li><a class="reference internal" href="#the-procedure-of-the-data-read">The Procedure of the Data Read</a></li>
<li><a class="reference internal" href="#the-detail-of-each-part">The Detail of Each Part</a><ul>
<li><a class="reference internal" href="#reformatdata">ReformatData</a></li>
<li><a class="reference internal" href="#dataformat">DataFormat</a></li>
<li><a class="reference internal" href="#dataset">Dataset</a></li>
<li><a class="reference internal" href="#id1">DataPipeline</a></li>
<li><a class="reference internal" href="#camera">Camera</a><ul>
<li><a class="reference internal" href="#id2">Camera</a></li>
<li><a class="reference internal" href="#trainablecamera">TrainableCamera</a></li>
<li><a class="reference internal" href="#cameras">Cameras</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    </body>
</html>